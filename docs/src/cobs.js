define(["exports"],function(_exports){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.COBSDecoderStream=_exports.decode=_exports.encode=void 0;_exports.encode=function encode(buffer){var result=[],resultIter=0,overheadBytePosition=0,overheadByte=1,startBlock=function(){overheadBytePosition=resultIter++;overheadByte=1},endBlock=function(){result[overheadBytePosition]=overheadByte};startBlock();var bufferIter=0;while(bufferIter<buffer.length){if(255!=overheadByte){var value=buffer[bufferIter++];if(0!=value){result[resultIter++]=value;overheadByte++;continue}}endBlock();startBlock()}endBlock();return result};_exports.decode=function decode(buffer){var result=[],resultIter=0,overheadByte=255,copy=0,i=0;while(i<buffer.length){if(0!=copy){result[resultIter++]=buffer[i++]}else{if(255!=overheadByte){result[resultIter++]=0}copy=overheadByte=buffer[i++];if(0==overheadByte){break}}copy--}return result};_exports.COBSDecoderStream=function COBSDecoderStream(){babelHelpers.classCallCheck(this,COBSDecoderStream);var _controller=null;this.readableStream=new ReadableStream({start:function start(controller){_controller=controller},cancel:function cancel(){}});this.writableStream=new WritableStream({start:function start(){this.reset()},reset:function reset(){this.result=[];this.resultIter=0;this.overheadByte=255;this.copy=0},write:function write(chunk){var _this=this;return new Promise(function(resolve){var i=0;while(i<chunk.length){if(0!=_this.copy){_this.result[_this.resultIter++]=chunk[i++]}else{if(255!=_this.overheadByte){_this.result[_this.resultIter++]=0}_this.copy=_this.overheadByte=chunk[i++];if(0==_this.overheadByte){_this.result.pop();var newData=new Uint8Array(_this.result);if(_controller){_controller.enqueue(newData)}_this.reset();continue}}_this.copy--}resolve()})}})}});